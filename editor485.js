/*
* AvacWeb Editor was designed exclusively for AvacWeb and for use on AvacWeb.com ONLY. 
* Copyright (c) 2012. All Rights Reserved.
* Absolutely no use without consent. 
* If you are interested in purchasing an editor like the AvacWeb Editor contact LGforum. 
*/
(function(a,b){"undefined"!=typeof module?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define(b):this[a]=b()})("selix",function(){function a(a,b){return a.value.slice(0,b).split("\r\n").length-1}function b(){document.body.appendChild(d);"number"==typeof d.selectionStart&&"number"==typeof d.selectionEnd?c.w3c=c.supported=!0:"object"==typeof document.selection&&e.test(document.selection.createRange)&&e.test(d.createTextRange)&&(c.msie=c.supported=!0);document.body.removeChild(d);
c.w3c?(f=function(a){return a.value.slice(a.selectionStart,a.selectionEnd)},g=function(a){return{start:a.selectionStart,end:a.selectionEnd}},h=function(a,b,c){a.selectionStart=b;a.selectionEnd=c},k=function(a,b){b?a.selectionEnd=a.selectionStart:a.selectionStart=a.selectionEnd}):c.msie&&(f=function(a){var b=a.ownerDocument.selection.createRange();return b&&b.parentElement()===a?b.text:null},g=function(b){var c=b.ownerDocument.selection.createRange(),d=0,e=0,f,g,h;return c&&c.parentElement()===b&&
(h=b.value.length,f=b.createTextRange(),f.moveToBookmark(c.getBookmark()),g=b.createTextRange(),g.collapse(!1),0<=f.compareEndPoints("StartToEnd",g)?d=e=h:(d=-f.moveStart("character",-h),d+=a(b,d),0<=f.compareEndPoints("EndToEnd",g)?e=h:(e=-f.moveEnd("character",-h),e+=a(b,e)))),{start:d,end:e}},h=function(b,c,d){var e=b.createTextRange(),f=c-a(b,c);b=d-a(b,d);e.collapse(!0);c===d?e.moveStart("character",f):(e.moveEnd("character",b),e.moveStart("character",f));e.select()},k=function(a,b){var c=a.createTextRange();
c.collapse(b);c.select()});c.carriage=a;c.getText=f;c.getCaret=g;c.setCaret=h;c.collapse=k;c.setText=function(a,b){var c=g(a),d=a.value;a.value=d.slice(0,c.start)+b+d.slice(c.end)};c.wrap=function(a,b,d,e){var h=f(a),k=g(a).start+b.length;c.setText(a,b+h+d);e&&c.setCaret(a,k,k+h.length)}}var c={},d=document.createElement("textarea"),e=/function|object/,f,g,h,k;return window.ender&&ender.domReady?ender.domReady(b):window.jQuery?jQuery(b):window.addEventListener?window.addEventListener("load",b,!1):
window.attachEvent&&window.attachEvent("onload",b),c});
var avac_editor={box:!1,curpop:!1,info:{editing:!1,colorsMade:!1,smiliesMade:!1,selection:""},user:{},cache:{edit:{},quote:{}},popup:function(a,b){if("string"===typeof b){var c=document.getElementById(b);"editor-color"!=b||avac_editor.info.colorsMade||avac_editor.createColors();"editor-smilies"!=b||avac_editor.info.smiliesMade||avac_editor.createSmilies()}else c=b;"none"==c.style.display?(avac_editor.curpop&&(avac_editor.curpop.style.display="none"),c.style.display="",avac_editor.curpop=c,c.style.marginLeft=
a.clientX/5+"px"):(c.style.display="none",avac_editor.curpop=!1)},createColors:function(){for(var a="FEDCBA9876543210".split(""),b='<table border="0" cellpadding="0" cellspacing="0">',c=a.length,d=0;d<c;d++){for(var b=b+"<tr>",e=0;e<c;e++)for(var f=0;f<c;f++)var g="#"+a[d]+a[d]+a[e]+a[e]+a[f]+a[f],b=b+('<td style="background:'+g+'; padding: 2px 1px; margin: 0; border: none" onclick="avac_editor.insert(\'[color='+g+"]','[/color]');\"></td>");b+="</tr>"}b+="</table>";document.getElementById("colortable").innerHTML=
b;avac_editor.info.colorsMade=!0},createSmilies:function(){var a=smilieoptions,b='<div id="sel_smilies_content" align="center">',c;for(c in a)b+="<img onclick=\"avac_editor.insert('"+a[c][2]+"', ' ');\" alt=\""+a[c][1]+'" title="'+a[c][1]+'" src="'+a[c][0]+'" />';b+="</div>";document.getElementById("editor-smilies").innerHTML=b;avac_editor.info.smiliesMade=!0},insert:function(a,b){var c=document.getElementById("editor-textbox");c.focus();var d=selix.getText(c),e=selix.getCaret(c);selix.setText(c,
a+d+b);selix.setCaret(c,e.start+a.length,e.start+d.length+a.length)},special_insert:function(a){var b,c;switch(a){case "tip":a=document.getElementById("editor-tip-input");var d=document.getElementById("editor-tip-text");b=(0<d.value.length?"[tip="+d.value+"]":"[tip]")+a.value+"[/tip] ";c="";a.value="";d.value="";break;case "img":b="[img]"+document.getElementById("editor-img-input").value+"[/img] ";c="";document.getElementById("editor-img-input").value="";break;case "hex":b="[color="+document.getElementById("editor-hex-input").value+
"]",c="[/color]",document.getElementById("editor-hex-input").value=""}avac_editor.insert(b,c)},find_new_link:function(a){a=a.substring(a.indexOf("<a href=")+9);return a.substring(0,a.indexOf('"'))},stolen:function(){for(var a=0;100>a;a++)document.body.innerHTML="Don't steal from tajribe.<br><br>"+document.body.innerHTML},prepare:function(){if(-1==window.location.hostname.indexOf("tajribe
")&&-1==window.location.hostname.indexOf("testlg"))return avac_editor.stolen();var a=document.getElementById("quick_reply");
a&&(avac_editor.info.tid=a.tid.value,avac_editor.info.t=a.t.value,avac_editor.info.lt=a.lt.value,a.parentNode.removeChild(a.previousSibling.previousSibling.previousSibling),a.parentNode.removeChild(a),avac_editor.insert_editor(),avac_editor.box=document.getElementById("avac-editor"),avac_editor.form=document.getElementById("avac-editor-form"),avac_editor.notice=document.getElementById("editor-notice"));/tajribe|testlg/.test(window.location.host)||avac_editor.stolen()},loadQuote:function(a){var b=
avac_editor.notice.innerHTML;avac_editor.notice.innerHTML="Loading post..";var c=avac_editor.cachePost("quote",a),d=document.getElementById("editor-rubbish"),e=function(c){var d=document.getElementById("p"+a).post_link;avac_editor.form.message.value+=c.replace("]",'][quotelink="'+d+'"]');avac_editor.notice.innerHTML=b};if(c)return e(c);$(d).load("/post?mode=quote&p="+a+" textarea",function(){var b=d.getElementsByTagName("textarea")[0].value;d.innerHTML="";e(avac_editor.cachePost("quote",a,b))})},
loadEdit:function(a){var b=document.getElementById("editor-rubbish"),c=function(a){avac_editor.form.message.value=a;avac_editor.notice.innerHTML="Editing post..."},d=avac_editor.cachePost("edit",a);if(d)return c(d);$(b).load("/post?mode=editpost&p="+a+" textarea",function(){var d=b.getElementsByTagName("textarea")[0].value;b.innerHTML="";c(avac_editor.cachePost("edit",a,d))})},getSelection:function(){var a="";window.getSelection?a=(a=document.activeElement)&&a.tagName.toLowerCase()in{textarea:1,input:1}?
a.value.substring(a.selectionStart,a.selectionEnd):window.getSelection().toString():document.selection.createRange&&(a=document.selection.createRange().text||"");avac_editor.info.selection=a},begin:function(a,b){var c=avac_editor.info.pid!==b;avac_editor.info.pid=b;avac_editor.form.tid.value=avac_editor.info.tid;var d=document.getElementById("editor_box_"+b),e=document.getElementById("p"+b),f=-1===document.title.indexOf(" Page"),g=document.title.replace(/\s*-\s*Page\s*\d+/,"");avac_editor.form.subject.value=
e.is_first_post&&f?g:"Re: "+g;switch(a){case "quote":if(f=avac_editor.info.selection,0<f.length?avac_editor.insert('[quote="'+e.author+'"][quotelink="'+e.post_link+'"]'+f+"[/quote] ",""):avac_editor.loadQuote(b),avac_editor.info.selection="",avac_editor.info.open)break;case "reply":avac_editor.notice.innerHTML="Replying to topic...";avac_editor.form.t.value=avac_editor.info.t;avac_editor.form.mode.value="reply";avac_editor.form.p.value="";avac_editor.info.editing=!1;avac_editor.form.lt.value=avac_editor.info.lt;
break;case "edit":avac_editor.info.editing=!0;avac_editor.form.t.value="";avac_editor.form.lt.value=avac_editor.info.lt;avac_editor.form.mode.value="editpost";avac_editor.form.p.value=b;avac_editor.form.message.value="";avac_editor.notice.innerHTML="Loading post...";avac_editor.loadEdit(b);break;case "delete":LGmodal.confirm("Are you sure you want to delete this post?",function(a){a&&$.post("/post","mode=delete&confirm=Yes&p="+b+"&tid="+avac_editor.info.tid,function(a){a.indexOf("deleted successfully")&&
$("#p"+b).fadeOut(function(){$("#p"+b).remove()})})});return;case "ip":window.location="/modcp?mode=ip&p="+b+"&t="+avac_editor.info.t+"&tid="+avac_editor.info.tid;return;case "post":avac_editor.insert("[post]"+e.post_link+"[/post] ","");if(!avac_editor.info.open)return avac_editor.begin("reply",b);break;case "at":if(avac_editor.insert(" @"+e.author+" ",""),!avac_editor.info.open)return avac_editor.begin("reply",b)}avac_editor.form.hashtags||HashTag.add_to_form(avac_editor.form);d.appendChild(avac_editor.box);
if(!avac_editor.info.open||c)avac_editor.box.style.display="none",$(avac_editor.box).slideDown();avac_editor.form.message.focus();avac_editor.info.open=!0},cachePost:function(a,b,c){c&&0<c.length&&(avac_editor.cache[a]["p"+b]=c);return avac_editor.cache[a]["p"+b]||null},full_editor:function(){cookie("avac_editor_saved",escape(avac_editor.form.message.value),!1);if(avac_editor.info.editing)return window.location="/post?mode=editpost&p="+avac_editor.info.pid;window.location="/post?mode=reply&t="+avac_editor.info.t},
send:function(){avac_editor.info.inpreview&&avac_editor.close_preview();if(2>avac_editor.form.message.value.length)return avac_editor.notice.innerHTML='<span style="color:red">Message must be more than 2 characters</span>',!1;avac_editor.info.save_post=avac_editor.form.message.value;avac_editor.loading();var a=$(avac_editor.form).serialize()+"&post=1";$.post(avac_editor.form.action,a,function(a){var c=a.indexOf("entered successfully");avac_editor.loading(!0);if(0<c){var d=avac_editor.find_new_link(a.substring(c));
HashTag.send_data(avac_editor.form.id,avac_editor.form.subject.value,d,avac_editor.info.save_post,function(){avac_editor.finish_up(d)})}else avac_editor.box.style.display="",avac_editor.form.message.value=avac_editor.info.save_post,avac_editor.info.last_response=a,avac_editor.notice.innerHTML='<span style="color:red">Sorry, message not sent. <a id="send-error" href="#"onclick="LGsend_error_report(avac_editor.info.last_response);return false">Send Error Report</a></span>'});avac_editor.kill()},kill:function(){avac_editor.form.message.value=
"";avac_editor.info.open=!1;avac_editor.box.style.display="none";var a=select(".hashtag_box",avac_editor.box)[0];a&&(a.innerHTML="")},preview:function(){if(avac_editor.info.inpreview)return avac_editor.close_preview();if(2>avac_editor.form.message.value.length)return avac_editor.notice.innerHTML='<span style="color:red">Message must be more than 2 characters</span>',!1;var a=$(avac_editor.form).serialize()+"&preview=Preview",a=a.replace("&prevent_post=1","");avac_editor.info.last_notice=avac_editor.notice.innerHTML;
avac_editor.notice.innerHTML="Loading preview...";$.post(avac_editor.form.action,a,function(a){a=a.substring(a.indexOf('class="h3">Preview'));a=a.substring(0,a.indexOf('class="corners-bottom">'));a=a.replace(/.*class="content"\>(.*?)\<\/div\>\<\/div\>\<span/,"$1");avac_editor.display_prev(a)})},display_prev:function(a){var b=document.getElementById("editor-preview");b.innerHTML='<div id="editor-preview-inner">'+LGBB.parse(a)+"</div>";create_user_tags(b);add_tip_listeners(b);b.style.width=avac_editor.box.offsetWidth-
8+"px";avac_editor.notice.innerHTML="Previewing...";document.getElementById("editor-prev-btn").innerHTML="Close";b.style.display="";avac_editor.info.inpreview=!0},close_preview:function(){var a=document.getElementById("editor-preview");a.innerHTML="";avac_editor.notice.innerHTML=avac_editor.info.last_notice;document.getElementById("editor-prev-btn").innerHTML="Preview";a.style.display="none";avac_editor.info.inpreview=!1},finish_up:function(a){if(avac_editor.info.editing){avac_editor.loading();var b=
avac_editor.info.pid;avac_editor.cachePost("edit",b,avac_editor.info.save_post);var c=$(".content",document.getElementById("p"+b)).html("Editing..."),d=document.getElementById("editor-rubbish");$(d).load(a+" #p"+b,function(){c.html(LGBB.parse($(".content",d.firstChild)[0].innerHTML));create_user_tags(c[0]);add_tip_listeners(c[0]);d.innerHTML="";avac_editor.loading(!0)})}else ajax_inject(a),location.hash="",location.hash="#bottomtitle"},loading:function(a,b){var c=document.getElementById("overlay");
a?(document.body.removeChild(document.getElementById("editor-loading")),c.style.display="none"):(c.style.display="block",c=document.createElement("div"),c.id="editor-loading",c.innerHTML=b?b:"Loading...",document.body.appendChild(c))},insert_editor:function(){var a=document.getElementById("avac-editor-holder");a&&(a.innerHTML='<div id="avac-editor"><a name="editor"></a><span id="editor-rubbish"style="display:none"></span><div id="editor-preview"style="display:none"></div><form id="avac-editor-form"method="post"name="fm_avac_editor"action="/post"><div id="editor-head"><div id="editor-bb"><span title="Bold"class="bb-btn"onclick="avac_editor.insert(\'[b]\',\'[/b]\')">B</span><span title="Underline"class="bb-btn"onclick="avac_editor.insert(\'[u]\',\'[/u]\')">U</span><span title="Italic"class="bb-btn"onclick="avac_editor.insert(\'[i]\',\'[/i]\')">I</span><span class="bb-btn"onclick="avac_editor.insert(\'[code][panda=js]\',\'[/code]\')" title="Javascript Highlighted code">Javascript</span><span class="bb-btn"onclick="avac_editor.insert(\'[code][panda=css]\',\'[/code]\')" title="CSS Highlighted code">CSS</span><span class="bb-btn"onclick="avac_editor.insert(\'[code][panda=html]\',\'[/code]\')" title="HTML Highlighted code">HTML</span><span class="bb-btn"onclick="avac_editor.popup(event,\'editor-image\')">Image</span><span class="bb-btn"onClick="avac_editor.popup(event,\'editor-tip\')">Tip</span><span class="bb-btn"onClick="avac_editor.popup(event,\'editor-color\')">Color</span><span class="bb-btn"onClick="avac_editor.popup(event,\'editor-smilies\')">Smilies</span><span class="editor-btn"onClick="avac_editor.insert(\'[ic]\',\'[/ic]\')">Inline Code</span><span class="bb-btn"onClick="avac_editor.insert(\'[quote]\',\'[/quote]\')">Quote</span><span class="bb-btn"onClick="avac_editor.popup(event,\'editor-other\')">Other</span><span class="editor-copyright">Exclusive to tajribe &copy;</span></div></div><div id="editor-popups"><div id="editor-tip"class="editor-popup"style="display:none;"><span class="editor-input"><label for="tip">Tip:&nbsp;</label><input type="text"id="editor-tip-input"></span><span class="editor-input"><label for="tiptext">Text:</label><input type="text"id="editor-tip-text"></span><span class="editor-btn"onClick="avac_editor.special_insert(\'tip\')">Okay</span></div><div id="editor-image"class="editor-popup"style="display:none"><span class="editor-input"><label for="img">URL:</label><input type="text"id="editor-img-input"><br><span class="editor-btn"onClick="avac_editor.special_insert(\'img\')">Okay</span></span><span class="editor-btn"onclick="avac_editor.popup(event,\'editor-upload\')">Upload an Image</span></div><div id="editor-color"class="editor-popup"style="display:none"><span id="colortable"class="editor-input"></span><span class="editor-input"><label for="hex">Hex:</label><input type="text"id="editor-hex-input"name="hex"><span class="editor-btn"onClick="avac_editor.special_insert(\'hex\')">Enter</span></span></div><div id="editor-smilies"class="editor-popup"style="display:none"></div><div id="editor-other"class="editor-popup"style="display:none"><span class="editor-btn"onClick="avac_editor.insert(\'[bspoiler]\',\'[/bspoiler]\')">Button Spoiler</span><span class="editor-btn"onClick="avac_editor.insert(\'[spoiler]\',\'[/spoiler]\')">Standard Spoiler</span><span class="editor-btn"onClick="avac_editor.insert(\'[code]\',\'[/code]\')">Code</span><span class="editor-btn"onclick="avac_editor.insert(\'[noguest]\', \'[/noguest]\')" title="Contents inbetween will not show up to guests">No Guest</span><span class="editor-btn"onClick="avac_editor.insert(\'[div=avacblock]\',\'[/div]\')">Avac Box</span><span class="editor-btn"onClick="avac_editor.insert(\'[h3]\',\'[/h3]\')">Header</span></div><div id="editor-upload"class="editor-popup"style="display:none"><iframe src="http://www.servimg.com/forum_upload.php?account=lgforum@avacweb.com&amp;id=115f8951ba1ff35acd1a885ef996dc28&amp;f=6310219" width="500" height="200" border="0" scrolling="no" seamless="seamless"></iframe></div></div><div id="editor-main"><textarea id="editor-textbox"name="message"onFocus="if(avac_editor.curpop){avac_editor.popup(event,avac_editor.curpop)}"></textarea></div><div id="editor-foot"><span class="editor-btn"onclick="avac_editor.preview()"id="editor-prev-btn">Preview</span><span class="editor-btn"onclick="avac_editor.full_editor()"id="editor-full-btn">Full Editor</span><span class="editor-btn"style="font-weight:bold"onclick="avac_editor.send()">Send</span><div id="editor-notice">Replying to topic</div></div><input name="mode"type="hidden"value="reply"/><input name="p"type="hidden"value=""/><input name="tid"type="hidden"value=""/><input name="t"type="hidden"value=""/><input name="lt"type="hidden"value=""/><input name="folder"type="hidden"value=""><input name="prevent_post"type="hidden"value="1"><input name="subject"type="hidden"value=""></form></div>')}};
-1===window.location.host.indexOf("tajribe")&&-1===window.location.host.indexOf("testlg")||document.write('<div id="avac-editor-holder"></div>');$(function(){avac_editor.prepare()});
